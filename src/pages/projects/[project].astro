---
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import Layout from "@/layouts/Layout.astro";
import { GitHubLogoIcon } from "@radix-ui/react-icons";
import { getCollection } from "astro:content";
import { ExternalLink } from "lucide-react";
import { CldImage } from "astro-cloudinary";

export async function getStaticPaths() {
  const projects = await getCollection("projects");

  return projects.map(({ slug, data }) => ({
    params: {
      project: slug,
    },
    props: {
      project: data,
    },
  }));
}

const { project } = Astro.props;
---

<Layout>
  <main class="flex flex-col gap-20">
    <div class="space-y-6">
      <div class="space-y-2">
        <h1 class="text-3xl font-bold">{project.title}</h1>
        <Badge className="text-sm w-fit" variant={"secondary"}
          >{project.type}</Badge
        >
      </div>
      <div class="flex gap-4">
        <Button>
          Ir a la página
          <ExternalLink className="w-4 h-4 ml-2" />
        </Button>
        <Button variant={"outline"}>
          Ver código
          <GitHubLogoIcon className="w-4 h-4 ml-2" />
        </Button>
      </div>
    </div>
    {
      project.sections.map((section, index) => {
        const order =
          index % 2 === 0 ? "flex-row" : "flex-row-reverse";

        return (
          <div class={`flex  gap-6  md:gap-12 ${order}`}>
            <div class={`flex flex-col gap-4 flex-1 `}>
              <h2 class="text-2xl font-bold tracking-tighter">
                {section.title}
              </h2>
              <p class="text-muted-foreground">{section.content}</p>
            </div>
            <div class={`flex flex-col gap-4 flex-1 max-w-2xl`}>
              {section.images.map((image) => (
                <CldImage
                  src={`portfolio-renew/${image.src}`}
                  alt={image.alt}
                />
              ))}
            </div>
          </div>
        );
      })
    }
  </main>
</Layout>
